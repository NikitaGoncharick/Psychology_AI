<div class="chat-wrapper">

    <!-- Ð›ÐµÐ²Ð°Ñ Ð±Ð¾ÐºÐ¾Ð²Ð°Ñ Ð¿Ð°Ð½ÐµÐ»ÑŒ -->
    <div class="sidebar">


      <div class="d-flex align-items-center gap-3">
        <div class="user-avatar">U</div>
        <div>
          <div class="fw-medium">Guest User</div>
          <small class="text-muted">Guest</small>
        </div>
      </div>
    </div>

    <!-- Ñ‡Ð°Ñ‚ -->
    <div class="chat-main d-flex flex-column">

      <div class="border-bottom px-4 py-1 bg-white">
        <h5 class="mb-1 fw-bold text-dark">Psychology AI</h5>
        <small class="text-muted">A calm space to talk, whenever you need</small>
        <!--<span class="badge bg-success-subtle text-success-emphasis float-end mt-2">Gentle mode</span> -->
      </div>

      <div id="messages" class="flex-grow-1 overflow-auto px-4 py-4"></div>

      <div id="typing" class="htmx-indicator px-4 pb-1">
        <div class="msg-ai d-inline-block p-1"><i>typing...</i></div>
      </div>

      <div class="chat-footer">
        <!--Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‘Ñ‚ Ñ‚ÐµÐºÑÑ‚ Ð² Python-Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ-->
        <!--hx-post Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð¿ÐµÑ€ÐµÑ…Ð²Ð°Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ Ð¾Ð±Ñ‹Ñ‡Ð½ÑƒÑŽ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÑƒ Ñ„Ð¾Ñ€Ð¼Ñ‹ Ð¸ Ð´ÐµÐ»Ð°ÐµÑ‚ ÐµÑ‘ Ñ‡ÐµÑ€ÐµÐ· AJAX Ð²Ð¼ÐµÑÑ‚Ð¾ Ð¿ÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñ‹-->
        <form hx-post="/guest/send" hx-target="#messages" hx-swap="beforeend" hx-indicator="#typing">
          <div class="input-group">
            <input name="text" class="form-control shadow-sm input-message" placeholder="Share what's on your mind..." autofocus required>
            <button type="submit" class="btn btn-send"> > </button>
          </div>
        </form>

        <div class="text-center mt-3">
          <small class="text-muted">
            This space is for reflection and support. It is not a substitute for emergency or crisis services.
          </small>
        </div>
      </div>

        <!-- ÐšÑ€Ð°ÑÐ¸Ð²Ð°Ñ Ð¼Ð¾Ð´Ð°Ð»ÐºÐ°: ÐºÐ¾Ð½ÐµÑ† Ð±ÐµÑÐ¿Ð»Ð°Ñ‚Ð½Ñ‹Ñ… ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹ -->
        <div class="modal fade" id="guestLimitModal" tabindex="-1" aria-labelledby="guestLimitModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content overflow-hidden border-0 shadow-xl" style="border-radius: 24px; max-width: 500px;">

              <!-- Ð“Ñ€Ð°Ð´Ð¸ÐµÐ½Ñ‚Ð½Ñ‹Ð¹ Ñ…ÐµÐ´ÐµÑ€ Ñ Ð²Ð¾Ð»Ð½Ð¾Ð¹ -->
              <div class="position-relative text-white text-center py-5" style="
                background: linear-gradient(135deg, #4a9086 0%, #6ab5a8 100%);
                border-radius: 24px 24px 0 0;
                overflow: hidden;
              ">
                <!-- Ð”ÐµÐºÐ¾Ñ€Ð°Ñ‚Ð¸Ð²Ð½Ð°Ñ Ð²Ð¾Ð»Ð½Ð° ÑÐ½Ð¸Ð·Ñƒ -->
                <svg viewBox="0 0 500 150" preserveAspectRatio="none" class="position-absolute bottom-0 start-0 w-100" style="height: 60px;">
                  <path d="M0,100 C150,150 350,50 500,100 L500,150 L0,150 Z" fill="white" opacity="0.15"></path>
                </svg>

                <!-- Ð‘Ð¾Ð»ÑŒÑˆÐ°Ñ Ð¸ÐºÐ¾Ð½ÐºÐ° Ñ ÑÐµÑ€Ð´Ñ†ÐµÐ¼ -->
                <div class="mx-auto mb-3 d-inline-flex align-items-center justify-content-center rounded-circle bg-white bg-opacity-20"
                     style="width: 90px; height: 90px; backdrop-filter: blur(10px);">
                  <i class="fs-1">ðŸ’™</i>
                </div>

                <h4 class="modal-title fw-bold mb-2 px-4" id="guestLimitModalLabel">
                  Youâ€™ve been truly heard
                </h4>
                <p class="mb-0 px-4 opacity-90" style="font-size: 1.05rem;">
                  Thank you for opening up and sharing
                </p>
              </div>

              <!-- Ð¢ÐµÐ»Ð¾ Ð¼Ð¾Ð´Ð°Ð»ÐºÐ¸ -->
              <div class="modal-body text-center py-5 px-4 bg-white">
                <p class="text-muted mb-4 lead" style="font-size: 1.1rem;">
                 Youâ€™ve reached the limit of 3 free messages in guest mode.
                </p>

                <p class="mb-5 text-dark" style="line-height: 1.6;">
                  To continue our calm and trusting conversation without limits â€”
                  <strong>join the community</strong>.
                </p>

                <!-- ÐšÐ½Ð¾Ð¿ÐºÐ¸ Ñ Ð¸ÐºÐ¾Ð½ÐºÐ°Ð¼Ð¸ Ð¸ Ð¼ÑÐ³ÐºÐ¾Ð¹ Ð°Ð½Ð¸Ð¼Ð°Ñ†Ð¸ÐµÐ¹ -->
                <div class="d-grid gap-3 mx-3">
                  <a href="/register" class="btn btn-lg fw-semibold position-relative overflow-hidden d-flex align-items-center justify-content-center gap-3"
                     style="
                       background: linear-gradient(135deg, #4a9086, #5ab8a9);
                       color: white;
                       border: none;
                       border-radius: 16px;
                       padding: 16px;
                       transition: all 0.3s ease;
                       box-shadow: 0 8px 25px rgba(74, 144, 134, 0.3);
                     "
                     onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 12px 30px rgba(74,144,134,0.4)'"
                     onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 8px 25px rgba(74,144,134,0.3)'">
                    <i class="fs-4">âœ¨</i>
                    <span>Create account</span>
                  </a>

                  <a href="/login" class="btn btn-lg btn-outline-secondary fw-medium"
                     style="border-radius: 16px; padding: 14px; border-width: 2px;">
                    I already have account
                  </a>
                </div>

                <div class="mt-5">
                  <small class="text-muted d-block mb-1">
                    It takes <strong>less than a minute</strong>
                  </small>
                </div>
              </div>
            </div>
          </div>
        </div>
    </div>
    <!-- ÐºÐ¾Ð½ÐµÑ† Ñ‡Ð°Ñ‚Ð° -->

  </div>